(()=>{"use strict";var t;function n(t){const n=[],e=document.querySelectorAll(t);return e.forEach((t=>n.push(t))),e}!function(t){t.TAB_CREATED="tabCreated",t.TAB_REPLACED="tabReplaced",t.TAB_UPDATED="tabUpdated",t.TAB_ACTIVATED="tabActivated",t.SEND_MEDIA="sendMedia"}(t||(t={}));const e=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:bmp|gif|jpe?g|png|svg|webp))(?:\?([^#]*))?(?:#(.*))?/i,r=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:mkv|flv|ogg|ogv|gifv|avi|mov|wmv|rm|rmvb|mp4|m4p|m4v|mpg|mpeg|3gp|3g2|webm))(?:\?([^#]*))?(?:#(.*))?/i,o=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:mp3|flac|ogg|wma))(?:\?([^#]*))?(?:#(.*))?/i;function i({src:t}){return!(t.includes("https://www.youtube.com")||t.includes("https://www.youtu.be")||t.includes("https://youtube.com")||t.includes("https://youtu.be"))}function u({src:t}){return!!t}function c(t){return t.startsWith("data:image")||e.test(t)}var a=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function u(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,c)}a((r=r.apply(t,n||[])).next())}))};function s(t){return null===t?null:t.startsWith("/")?`${window.location.origin}${t}`:t}function l(){return t=this,n=arguments,r=function*(t="",n=null,e=void 0){let r=null;t.length&&(r=yield function(t){return a(this,void 0,void 0,(function*(){if(null===t)return null;let n="";if(/^data:(.+);base64,/.test(t))n=function(t){const n=t.match(/^data:(.+);base64,/),e=n?n[1].split("/")[1]:null;return(null==e?void 0:e.startsWith("svg+xml"))?"svg":e}(t);else{const e=function(t){const n=t.split("/").pop();if(!n||!n.includes("."))return null;const e=n.split(".").pop();return e?e.toLowerCase().split("?")[0]:null}(t);if(e)n=e;else try{n=yield function(t){return a(this,void 0,void 0,(function*(){try{const n=(yield fetch(t,{method:"HEAD",referrer:window.location.origin})).headers.get("Content-Type");if(n&&n.split("/")[1].startsWith("svg+xml"))return"svg"}catch(t){return"png"}return null}))}(t)}catch(t){n="png"}}return n||"png"}))}(t));let o=null;null!==n&&"string"!=typeof n&&(o=function(t){const n=t.getAttribute("alt");return n?0===n.length?null:n:null}(n));const i={src:t,alt:o,type:r};return void 0!==e&&(i.poster=e),i},new((e=void 0)||(e=Promise))((function(o,i){function u(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,c)}a((r=r.apply(t,n||[])).next())}));var t,n,e,r}function f(t){return function(t){let n=[...new Map(t.map((t=>[t.src,t]))).values()];return n=n.filter((({src:t})=>!!t)),n}(t.map(d))}function d(t){const n={src:s(t.src)||"",type:t.type,alt:t.alt,selected:!1,poster:null,uuid:t.uuid};return void 0===t.poster||(n.poster=t.poster?s(t.poster):null),n}var v=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function u(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,c)}a((r=r.apply(t,n||[])).next())}))};function p(t){return v(this,void 0,void 0,(function*(){if("img"===t.tagName.toLowerCase())return l(y(t),t);if("a"===t.tagName.toLowerCase()){const n=t.href;if(c(n))return l(n,t)}const n=window.getComputedStyle(t).backgroundImage;if(n){const t=m(n);if(c(t))return l(t)}return l()}))}function h(t){return v(this,void 0,void 0,(function*(){if("video"===t.tagName.toLowerCase()){return l(y(t.querySelector("source")||t),t,function(t){let n=t.getAttribute("poster")||t.getAttribute("data-poster")||"";const e=null==n?void 0:n.indexOf("#");return e>=0&&(n=n.substring(0,e+1)),n}(t))}if("a"===t.tagName.toLowerCase()){const e=t.href;if((n=e).startsWith("data:video")||r.test(n))return l(e,t,null)}var n;return l("",null,null)}))}function g(t){return v(this,void 0,void 0,(function*(){if("audio"===t.tagName.toLowerCase()){return l(y(t.querySelector("source")||t),t)}if("a"===t.tagName.toLowerCase()){const e=t.href;if((n=e).startsWith("data:audio")||o.test(n))return l(e,t)}var n;return l()}))}function m(t){return t.replace(/^url\(["']?/,"").replace(/["']?\)$/,"")}function y(t){let n=t.getAttribute("src")||"";const e=null==n?void 0:n.indexOf("#");return e>=0&&(n=n.substring(0,e+1)),n}function w(t,e){return v(this,void 0,void 0,(function*(){const r=[...n(t)].map(e);return(yield Promise.all(r)).filter(u).filter(i)}))}!function(){var n,e,r,o;n=this,e=void 0,o=function*(){let n=null,e=[],r=[],o=[];try{const t=yield function(){return v(this,void 0,void 0,(function*(){return w("img, a, [style]",p)}))}(),n=Array.from(document.styleSheets).filter((t=>t.hasOwnProperty("cssRules"))).map((({cssRules:t})=>Array.from(t))).flat().filter((t=>t.style&&t.style.backgroundImage)).map((t=>m(t.style.backgroundImage))).filter((t=>!!t)).filter((t=>c(t))).map((t=>l(t)));e=f([...t,...n]),r=f(yield function(){return v(this,void 0,void 0,(function*(){return w("video, a",h)}))}()),o=f(yield function(){return v(this,void 0,void 0,(function*(){return w("audio, a",g)}))}())}catch(t){console.log({err:t}),n=Object.assign({},t)}!function(t,n){try{chrome.runtime.sendMessage({eventName:t,data:n},(t=>{}))}catch(t){}}(t.SEND_MEDIA,{error:n,image:e,audio:o,video:r})},new((r=void 0)||(r=Promise))((function(t,i){function u(t){try{a(o.next(t))}catch(t){i(t)}}function c(t){try{a(o.throw(t))}catch(t){i(t)}}function a(n){var e;n.done?t(n.value):(e=n.value,e instanceof r?e:new r((function(t){t(e)}))).then(u,c)}a((o=o.apply(n,e||[])).next())}))}()})();