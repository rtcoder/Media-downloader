(()=>{"use strict";var t;function n(t,n=null,e){e||(e=t=>{});try{chrome.runtime.sendMessage({eventName:t,data:n},e)}catch(t){}}function e(t){const n=[],e=document.querySelectorAll(t);return e.forEach((t=>n.push(t))),e}!function(t){t.TAB_CREATED="tabCreated",t.TAB_REPLACED="tabReplaced",t.TAB_UPDATED="tabUpdated",t.TAB_ACTIVATED="tabActivated",t.SEND_MEDIA="sendMedia",t.GET_TAB_INFO="getTabInfo"}(t||(t={}));const r=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:bmp|gif|jpe?g|png|svg|webp))(?:\?([^#]*))?(?:#(.*))?/i,o=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:mkv|flv|ogg|ogv|gifv|avi|mov|wmv|rm|rmvb|mp4|m4p|m4v|mpg|mpeg|3gp|3g2|webm))(?:\?([^#]*))?(?:#(.*))?/i,i=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:mp3|flac|ogg|wma))(?:\?([^#]*))?(?:#(.*))?/i;function u({src:t}){return!(t.includes("https://www.youtube.com")||t.includes("https://www.youtu.be")||t.includes("https://youtube.com")||t.includes("https://youtu.be"))}function c({src:t}){return!!t}function a(t){return t.startsWith("data:image")||r.test(t)}const s=(()=>{let t;const n=[];for(let e=0;e<256;e++){t=e;for(let n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})();function l(t){const n=function(t){let n=-1;for(let e=0;e<t.length;e++)n=n>>>8^s[255&(n^t.charCodeAt(e))];return~n>>>0}(t);return n.toString(16).padStart(8,"0")}var f=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function u(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,c)}a((r=r.apply(t,n||[])).next())}))};function d(t){return null===t?null:t.startsWith("/")?`${window.location.origin}${t}`:t}function v(){return t=this,n=arguments,r=function*(t="",n=null,e=void 0){let r=null;t.length&&(r=yield function(t){return f(this,void 0,void 0,(function*(){if(null===t)return null;let n;if(/^data:(.+);base64,/.test(t))n=function(t){const n=t.match(/^data:(.+);base64,/),e=n?n[1].split("/")[1]:null;return(null==e?void 0:e.startsWith("svg+xml"))?"svg":e}(t);else{const e=function(t){let n=t.split("/").pop();if(!n||!n.includes("."))return null;n=n.split("?")[0];const e=n.split(".").pop();return e?e.toLowerCase().split("?")[0]:null}(t);if(e)n=e;else try{n=yield function(t){return f(this,void 0,void 0,(function*(){try{const n=(yield fetch(t,{method:"HEAD",referrer:window.location.origin})).headers.get("Content-Type");if(n&&n.split("/")[1].startsWith("svg+xml"))return"svg"}catch(t){return"png"}return null}))}(t)}catch(t){n="png"}}return n||"png"}))}(t));let o=null;null!==n&&"string"!=typeof n&&(o=function(t){const n=t.getAttribute("alt");return n?0===n.length?null:n:null}(n));const i={src:t,alt:o,type:r};return void 0!==e&&(i.poster=e),i},new((e=void 0)||(e=Promise))((function(o,i){function u(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,c)}a((r=r.apply(t,n||[])).next())}));var t,n,e,r}function p(t){return function(t){let n=[...new Map(t.map((t=>[t.src,t]))).values()];return n=n.filter((({src:t})=>!!t)),n}(t.map(g))}function g(t){const n={src:d(t.src)||"",type:t.type,alt:t.alt,selected:!1,poster:null,uuid:t.uuid||(e=t.src,l(e.toString()))};var e;return void 0===t.poster||(n.poster=t.poster?d(t.poster):null),n}var h=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function u(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,c)}a((r=r.apply(t,n||[])).next())}))};function m(t){return h(this,void 0,void 0,(function*(){if("img"===t.tagName.toLowerCase())return v(A(t),t);if("a"===t.tagName.toLowerCase()){const n=t.href;if(a(n))return v(n,t)}const n=window.getComputedStyle(t).backgroundImage;if(n){const t=b(n);if(a(t))return v(t)}return v()}))}function y(t){return h(this,void 0,void 0,(function*(){if("video"===t.tagName.toLowerCase()){return v(A(t.querySelector("source")||t),t,function(t){let n=t.getAttribute("poster")||t.getAttribute("data-poster")||"";const e=null==n?void 0:n.indexOf("#");return e>=0&&(n=n.substring(0,e+1)),n}(t))}if("a"===t.tagName.toLowerCase()){const e=t.href;if((n=e).startsWith("data:video")||o.test(n))return v(e,t,null)}var n;return v("",null,null)}))}function w(t){return h(this,void 0,void 0,(function*(){if("audio"===t.tagName.toLowerCase()){return v(A(t.querySelector("source")||t),t)}if("a"===t.tagName.toLowerCase()){const e=t.href;if((n=e).startsWith("data:audio")||i.test(n))return v(e,t)}var n;return v()}))}function b(t){return t.replace(/^url\(["']?/,"").replace(/["']?\)$/,"")}function A(t){let n=t.getAttribute("src")||"";const e=null==n?void 0:n.indexOf("#");return e>=0&&(n=n.substring(0,e+1)),n}function C(t,n){return h(this,void 0,void 0,(function*(){const r=[...e(t)].map(n);return(yield Promise.all(r)).filter(c).filter(u)}))}(()=>{function e(e){return r=this,o=void 0,u=function*(){let r=null,o=[],i=[],u=[];try{const t=yield function(){return h(this,void 0,void 0,(function*(){return C("img, a, [style]",m)}))}(),n=Array.from(document.styleSheets).filter((t=>t.hasOwnProperty("cssRules"))).map((({cssRules:t})=>Array.from(t))).flat().filter((t=>t.style&&t.style.backgroundImage)).map((t=>b(t.style.backgroundImage))).filter((t=>!!t)).filter((t=>a(t))).map((t=>v(t)));o=p([...t,...n]),i=p(yield function(){return h(this,void 0,void 0,(function*(){return C("video, a",y)}))}()),u=p(yield function(){return h(this,void 0,void 0,(function*(){return C("audio, a",w)}))}())}catch(t){console.log({err:t}),r=Object.assign({},t)}n(t.SEND_MEDIA,{error:r,image:o,audio:u,video:i,tabInfo:e})},new((i=void 0)||(i=Promise))((function(t,n){function e(t){try{a(u.next(t))}catch(t){n(t)}}function c(t){try{a(u.throw(t))}catch(t){n(t)}}function a(n){var r;n.done?t(n.value):(r=n.value,r instanceof i?r:new i((function(t){t(r)}))).then(e,c)}a((u=u.apply(r,o||[])).next())}));var r,o,i,u}n(t.GET_TAB_INFO,{},(t=>{e(t)}))})()})();
//# sourceMappingURL=send_media.bundle.js.map