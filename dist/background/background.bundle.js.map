{"version":3,"file":"background/background.bundle.js","mappings":"mBAAA,ICAW,ECCA,EAMAA,EALAC,EDDAC,EDDPC,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC1F,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAiB,MAAEK,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,EAAQ,KAIjBO,KAAKR,EAAWK,EAAW,CAC7GH,GAAMN,EAAYA,EAAUa,MAAMhB,EAASC,GAAc,KAAKS,OAClE,GACJ,EAsDO,SAAS,EAAYO,GACxB,MAAMC,EAAkB,CAAED,OAC1BE,OAAOC,UAAUC,SAASH,EAC9B,CACO,SAAS,EAAgBI,EAAKC,GACjCJ,OAAOK,QAAQC,KAAKC,IAAIJ,EAAKC,EACjC,CACO,SAASI,EAAgBL,EAAKC,GAC7BA,EACAJ,OAAOK,QAAQC,KAAKG,IAAIN,EAAKC,GAG7BJ,OAAOK,QAAQC,KAAKG,IAAIN,EAEhC,CACO,SAASO,EAAYC,EAAWC,EAAO,KAAMR,GAChD,MAAMS,EAAMC,IACR,GAAId,OAAOe,QAAQC,UAEf,OAAO,KAENZ,IACDA,EAAYa,IAAD,GAGfb,EAASU,EAAI,EAEjB,IACId,OAAOe,QAAQL,YAAY,CAAEC,YAAWC,QAAQC,EACpD,CACA,MAAOK,GAEP,CACJ,CA2BO,SAASC,EAAkBC,GAC9BpB,OAAOqB,aAAaC,OAAOF,EAC/B,EC3HWzC,EAIR,IAAiB,EAAe,CAAC,IAHZ,MAAI,QACxBA,EAAoB,MAAI,QACxBA,EAAoB,MAAI,SCFjBD,EAIR,IAAc,EAAY,CAAC,IAHT,MAAI,QACrBA,EAAgB,KAAI,OACpBA,EAAkB,OAAI,SAG1B,SAAWD,GACPA,EAAyB,MAAI,QAC7BA,EAA8B,WAAI,YACrC,CAHD,CAGGA,IAAsBA,EAAoB,CAAC,IACvC,MAAM,EAAmB,CAC5B8C,MAAO,EAAUC,OACjBC,cAAehD,EAAkBiD,MACjCC,gBAAiB,KACjBC,mBAAmB,EACnBC,gBAAiB,EAAaC,MAC9BC,QAAS,CAAC,EACVC,aAAa,GChBV,SAASC,EAA6B7B,GACzC,EAAgB,CAAEqB,cAAehD,EAAkBiD,QAAS,EAAGD,oBACtDA,IACDA,EAAgB,EAAiBA,eAErCrB,EAASqB,EAAc,GAE/B,CCVO,IAAIS,EJsIiB9B,EKxG5B,SAAS+B,IACL,MAAMC,EAAiB,yBACvBH,GAA8BR,IAC1B,MAAMY,EAAcZ,IAAkBhD,EAAkB6D,WAElDC,EADUd,IAAkBhD,EAAkBiD,MAE9CU,EACA,GACAI,EAA6BH,EAC7BD,EACA,GLoEP,IAA8BK,IKnER,CAAEC,uBAAwBL,GLoEnDrC,OAAO2C,UAAUC,iBAAiBH,GAASI,OAAOC,GAAUC,QAAQC,IAAIF,KAJrE,SAA6BL,GAChCzC,OAAO2C,UAAUM,WAAWR,EAChC,CKjEQS,CAAoB,CAAEC,KAAMX,IL4D7B,SAAyBC,GAC5BzC,OAAOoD,OAAOC,SAASZ,EAC3B,CK7DQa,CAAgB,CAAEC,MAAOhB,GAAyB,GAE1D,CHxBqCiB,OAAOC,KAAK,GEpBjD,SAAWvB,GACPA,EAAkC,YAAI,aACtCA,EAAmC,aAAI,cACvCA,EAAkC,YAAI,aACtCA,EAAoC,cAAI,eACxCA,EAAiC,WAAI,YACrCA,EAAoD,8BAAI,4BACxDA,EAAmC,aAAI,aACvCA,EAAoC,cAAI,cAC3C,CATD,CASGA,IAAyBA,EAAuB,CAAC,IJ4HxB9B,EKxFhB,CAACsD,EAAOC,EAAYC,KAC5BzB,IACAzB,EAAYwB,EAAqB2B,YAAa,CAAEH,QAAOC,aAAYC,OAAM,ELuFzE5D,OAAO8D,KAAKC,UAAUC,YAAY5D,GAHlCJ,OAAO8D,KAAKG,YAAYD,aKlFbE,IACX/B,IACAzB,EAAYwB,EAAqBiC,cAAe,CAAET,MAAOQ,EAAWR,OAAQ,IL6E5E1D,OAAO8D,KAAKM,WAAWJ,aK3EbK,IACVlC,IACAzB,EAAYwB,EAAqBoC,aAAc,CAAEZ,MAAOW,GAAa,ILsErErE,OAAO8D,KAAKS,UAAUP,aKpEbJ,IACTzB,IACAzB,EAAYwB,EAAqBsC,YAAa,CAAEZ,OAAM,IL8EtD5D,OAAOoD,OAAOqB,UAAUT,aK5ENJ,IAClBzB,IA7CJ,SAAwByB,GACpB3B,GAA8BR,IAC1B,OAAQA,GACJ,KAAKhD,EAAkBiD,MLwH/B1B,OAAOoD,OAAOsB,eADQjC,GKrHV,MACJ,KAAKhE,EAAkB6D,WLuHLG,EKtHA,CAAEkC,SAAUf,EAAIe,ULuH1C3E,OAAO2C,UAAUiC,KAAKnC,GADnB,IAAuBA,CKpHtB,GAER,CAmCIoC,CAAejB,EAAI,ILwDnB5D,OAAOe,QAAQ+D,YAAYd,aKtDnBe,IACR5C,IACAhB,EAAkB,CACd6D,GAAI,mBACJC,MAAO,qBACPC,SAAU,CAAC,UAEf/D,EAAkB,CACd6D,GAAI,qBACJC,MAAO,iBACPC,SAAU,CAAC,WAtEnB,SAAsBH,GAClB,GAAuB,WAAnBA,EAAQI,OACR,OAEJ,MAAMC,ELyICpF,OAAOe,QAAQsE,cAAcC,QGhIjC,IAAwClF,IERXuB,IACxBA,IAAoByD,GACpB5E,EAAgB,CAAEoB,mBAAmB,IAEzCpB,EAAgB,CAAEmB,gBAAiByD,GAAiB,EFKxD,EAAgB,CAAEzD,gBAAiB,OAAQ,EAAGA,sBACrCA,IACDA,EAAkB,EAAiBA,iBAEvCvB,EAASuB,EAAgB,GEPjC,CA6DI4D,CAAaR,EAAQ,ILkCrB/E,OAAOqB,aAAaoD,UAAUT,aAAY,CAACwB,EAAM5B,KACxCA,GKjCM,EAAC4B,EAAM5B,KACE,qBAApB4B,EAAKC,WAIe,uBAApBD,EAAKC,YAAuCD,EAAKE,QACjD,EAAYF,EAAKE,QClFlB,SAAkChC,EAAQ,ONK1C,SAA8BiC,GAC1B/G,EAAUgH,KAAMC,eAAW,GAAQ,UAAWC,EAAWpC,EAAQ,MACpE,IAAKA,EAAO,CACR,MAAME,QAeX,WACH,OAAOhF,EAAUgH,UAAM,OAAQ,GAAQ,YACnC,IAAI1E,EAAI6E,EACR,IACI,IAAIC,EAAe,CAAEC,QAAQ,EAAMC,mBAAmB,IACjDtC,SAAa5D,OAAO8D,KAAKqC,MAAMH,GACpC,QAAMpC,aAAiC,EAASA,EAAI9D,OAAsE,QAA5DoB,EAAK0C,aAAiC,EAASA,EAAI9D,WAAwB,IAAPoB,OAAgB,EAASA,EAAGkF,WAAW,gBAA+E,QAA5DL,EAAKnC,aAAiC,EAASA,EAAI9D,WAAwB,IAAPiG,OAAgB,EAASA,EAAGK,WAAW,sCAC5R,KAEJxC,CACX,CACA,MAAOyC,GACH,OAAO,IACX,CACJ,GACJ,CA9B8BC,GAClB,IAAK1C,IAAQA,EAAIoB,GACb,OAEJ,GAAIpB,EAAIoB,IAAM,EACV,OAEJtB,EAAQE,EAAIoB,EAChB,OACMhF,OAAOuG,UAAUC,cAAc,CACjCC,OAAQ,CAAE/C,QAAOgD,WAAW,GAC5BC,MAAO,CAACb,IAEhB,GACJ,CMrBI,CAAqB,mEAAoEpC,EAC7F,CD4EQkD,CAAyBhD,EAAIoB,GAKjC,EL6BI5E,CAASoF,EAAM5B,EAAI,IApBpB,SAAmBxD,GACtBJ,OAAOe,QAAQ8F,UAAU7C,YAAY5D,EACzC,CKTAyG,EAAU,CAACC,EAASC,EAAQC,KACxB,IAAI9F,EACJ,GAA4B,QAArBA,EAAK6F,EAAOnD,WAAwB,IAAP1C,OAAgB,EAASA,EAAG8D,GAAhE,CAIA,GAAI8B,EAAQnG,YAAcuB,EAAqB+E,aAE3C,OLtDD,SAAgBvD,GACnB,OAAO9E,EAAUgH,UAAM,OAAQ,GAAQ,YACnC,IAAI1E,EAAI6E,EACR,IACI,MAAMnC,QAAY5D,OAAO8D,KAAKvD,IAAImD,GAClC,OAAI1D,OAAOe,QAAQC,WACf+B,QAAQD,MAAM,uBAAwB9C,OAAOe,QAAQC,WAC9C,QAEL4C,aAAiC,EAASA,EAAI9D,OAAsE,QAA5DoB,EAAK0C,aAAiC,EAASA,EAAI9D,WAAwB,IAAPoB,OAAgB,EAASA,EAAGkF,WAAW,gBAA+E,QAA5DL,EAAKnC,aAAiC,EAASA,EAAI9D,WAAwB,IAAPiG,OAAgB,EAASA,EAAGK,WAAW,sCAC5R,KAEJxC,CACX,CACA,MAAOyC,GACH,OAAO,IACX,CACJ,GACJ,CKmCQa,CAAOH,EAAOnD,IAAIoB,IAAIpF,KAAKoH,IACpB,EAEX,GAAIF,EAAQnG,YAAcuB,EAAqBiF,8BAA+B,CAI1E,OAHcL,EAAQlG,KAAKwG,ME9FzBC,SAAQC,GAAQ,EAAYA,EAAKC,YFgGnCP,EAAa,KAEjB,CAVA,MAFIA,EAAa,KAYjB,G","sources":["webpack://media-downloader/./src/utils/chrome-api.ts","webpack://media-downloader/./src/types/media-in-tabs.type.ts","webpack://media-downloader/./src/storage/storage-def.ts","webpack://media-downloader/./src/storage/storage-fn.ts","webpack://media-downloader/./src/types/message-event-name.enum.ts","webpack://media-downloader/./src/background/background.ts","webpack://media-downloader/./src/downloader/find-media.ts","webpack://media-downloader/./src/utils/download-functions.ts"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport function executeContentScript(scriptUrl_1) {\n    return __awaiter(this, arguments, void 0, function* (scriptUrl, tabId = null) {\n        if (!tabId) {\n            const tab = yield getCurrentTab();\n            if (!tab || !tab.id) {\n                return;\n            }\n            if (tab.id <= 0) {\n                return;\n            }\n            tabId = tab.id;\n        }\n        yield chrome.scripting.executeScript({\n            target: { tabId, allFrames: true },\n            files: [scriptUrl],\n        });\n    });\n}\nexport function getCurrentTab() {\n    return __awaiter(this, void 0, void 0, function* () {\n        var _a, _b;\n        try {\n            let queryOptions = { active: true, lastFocusedWindow: true };\n            let [tab] = yield chrome.tabs.query(queryOptions);\n            if (!(tab === null || tab === void 0 ? void 0 : tab.url) || ((_a = tab === null || tab === void 0 ? void 0 : tab.url) === null || _a === void 0 ? void 0 : _a.startsWith('chrome://')) || ((_b = tab === null || tab === void 0 ? void 0 : tab.url) === null || _b === void 0 ? void 0 : _b.startsWith('https://chromewebstore.google.com'))) {\n                return null;\n            }\n            return tab;\n        }\n        catch (_c) {\n            return null;\n        }\n    });\n}\nexport function getTab(tabId) {\n    return __awaiter(this, void 0, void 0, function* () {\n        var _a, _b;\n        try {\n            const tab = yield chrome.tabs.get(tabId);\n            if (chrome.runtime.lastError) {\n                console.error('Error get tab by ID:', chrome.runtime.lastError);\n                return null;\n            }\n            if (!(tab === null || tab === void 0 ? void 0 : tab.url) || ((_a = tab === null || tab === void 0 ? void 0 : tab.url) === null || _a === void 0 ? void 0 : _a.startsWith('chrome://')) || ((_b = tab === null || tab === void 0 ? void 0 : tab.url) === null || _b === void 0 ? void 0 : _b.startsWith('https://chromewebstore.google.com'))) {\n                return null;\n            }\n            return tab;\n        }\n        catch (_c) {\n            return null;\n        }\n    });\n}\nexport function downloadUrl(url) {\n    const downloadOptions = { url };\n    chrome.downloads.download(downloadOptions);\n}\nexport function getStorageValue(obj, callback) {\n    chrome.storage.sync.get(obj, callback);\n}\nexport function setStorageValue(obj, callback) {\n    if (callback) {\n        chrome.storage.sync.set(obj, callback);\n    }\n    else {\n        chrome.storage.sync.set(obj);\n    }\n}\nexport function sendMessage(eventName, data = null, callback) {\n    const cb = (res) => {\n        if (chrome.runtime.lastError) {\n            // console.error('Error send msg:', chrome.runtime.lastError);\n            return null;\n        }\n        if (!callback) {\n            callback = (response) => {\n            };\n        }\n        callback(res);\n    };\n    try {\n        chrome.runtime.sendMessage({ eventName, data }, cb);\n    }\n    catch (_a) {\n        // do nothing\n    }\n}\nexport function onMessage(callback) {\n    chrome.runtime.onMessage.addListener(callback);\n}\nexport function createTab(details) {\n    chrome.tabs.create(details);\n}\nexport function setPopupOptions(options) {\n    chrome.action.setPopup(options);\n}\nexport function setSidePanelOptions(options) {\n    chrome.sidePanel.setOptions(options);\n}\nexport function setSidePanelBehavior(options) {\n    chrome.sidePanel.setPanelBehavior(options).catch((error) => console.log(error));\n}\nexport function contextMenuClicked(callback) {\n    chrome.contextMenus.onClicked.addListener((info, tab) => {\n        if (!tab) {\n            return;\n        }\n        callback(info, tab);\n    });\n}\nexport function onInstalled(callback) {\n    chrome.runtime.onInstalled.addListener(callback);\n}\nexport function createContextMenu(properties) {\n    chrome.contextMenus.create(properties);\n}\nexport function onCreateTab(callback) {\n    chrome.tabs.onCreated.addListener(callback);\n}\nexport function onReplaceTab(callback) {\n    chrome.tabs.onReplaced.addListener(callback);\n}\nexport function onActivateTab(callback) {\n    chrome.tabs.onActivated.addListener(callback);\n}\nexport function onUpdateTab(callback) {\n    chrome.tabs.onUpdated.addListener(callback);\n}\nexport function onClickExtensionIcon(callback) {\n    chrome.action.onClicked.addListener(callback);\n}\nexport function openPopup(options) {\n    chrome.action.openPopup(options);\n}\nexport function openSidePanel(options) {\n    chrome.sidePanel.open(options);\n}\nexport function getVersion() {\n    return chrome.runtime.getManifest().version;\n}\n","export var ItemTypeEnum;\n(function (ItemTypeEnum) {\n    ItemTypeEnum[\"IMAGE\"] = \"image\";\n    ItemTypeEnum[\"AUDIO\"] = \"audio\";\n    ItemTypeEnum[\"VIDEO\"] = \"video\";\n})(ItemTypeEnum || (ItemTypeEnum = {}));\n","import { ItemTypeEnum } from '../types/media-in-tabs.type';\nexport var ThemeType;\n(function (ThemeType) {\n    ThemeType[\"LIGHT\"] = \"light\";\n    ThemeType[\"DARK\"] = \"dark\";\n    ThemeType[\"SYSTEM\"] = \"system\";\n})(ThemeType || (ThemeType = {}));\nexport var DefaultActionType;\n(function (DefaultActionType) {\n    DefaultActionType[\"POPUP\"] = \"popup\";\n    DefaultActionType[\"SIDE_PANEL\"] = \"side-panel\";\n})(DefaultActionType || (DefaultActionType = {}));\nexport const DEFAULT_SETTINGS = {\n    theme: ThemeType.SYSTEM,\n    defaultAction: DefaultActionType.POPUP,\n    previousVersion: null,\n    showChangelogLink: false,\n    lastOpenSection: ItemTypeEnum.IMAGE,\n    filters: {},\n    filtersOpen: false,\n};\nexport const DEFAULT_SETTINGS_KEYS = Object.keys(DEFAULT_SETTINGS);\n","import { ItemTypeEnum } from '../types/media-in-tabs.type';\nimport { getStorageValue } from '../utils/chrome-api';\nimport { DEFAULT_SETTINGS, DefaultActionType, ThemeType } from './storage-def';\nexport function getStorageDefaultActionValue(callback) {\n    getStorageValue({ defaultAction: DefaultActionType.POPUP }, ({ defaultAction }) => {\n        if (!defaultAction) {\n            defaultAction = DEFAULT_SETTINGS.defaultAction;\n        }\n        callback(defaultAction);\n    });\n}\nexport function getStorageThemeValue(callback) {\n    getStorageValue({ theme: ThemeType.SYSTEM }, ({ theme }) => {\n        if (!theme) {\n            theme = DEFAULT_SETTINGS.theme;\n        }\n        callback(theme);\n    });\n}\nexport function getStoragePreviousVersionValue(callback) {\n    getStorageValue({ previousVersion: null }, ({ previousVersion }) => {\n        if (!previousVersion) {\n            previousVersion = DEFAULT_SETTINGS.previousVersion;\n        }\n        callback(previousVersion);\n    });\n}\nexport function getShowChangeLogLinkValue(callback) {\n    getStorageValue({ showChangelogLink: false }, ({ showChangelogLink }) => {\n        callback(!!showChangelogLink);\n    });\n}\nexport function getLastOpenSectionValue(callback) {\n    getStorageValue({ lastOpenSection: ItemTypeEnum.IMAGE }, ({ lastOpenSection }) => {\n        if (!lastOpenSection) {\n            lastOpenSection = DEFAULT_SETTINGS.lastOpenSection;\n        }\n        callback(lastOpenSection);\n    });\n}\nexport function getFiltersValue(callback) {\n    getStorageValue({ filters: {} }, ({ filters }) => {\n        if (!filters) {\n            filters = DEFAULT_SETTINGS.filters;\n        }\n        callback(filters);\n    });\n}\nexport function getFiltersOpenValue(callback) {\n    getStorageValue({ filtersOpen: false }, ({ filtersOpen }) => {\n        callback(!!filtersOpen);\n    });\n}\n","export var MessageEventNameEnum;\n(function (MessageEventNameEnum) {\n    MessageEventNameEnum[\"TAB_CREATED\"] = \"tabCreated\";\n    MessageEventNameEnum[\"TAB_REPLACED\"] = \"tabReplaced\";\n    MessageEventNameEnum[\"TAB_UPDATED\"] = \"tabUpdated\";\n    MessageEventNameEnum[\"TAB_ACTIVATED\"] = \"tabActivated\";\n    MessageEventNameEnum[\"SEND_MEDIA\"] = \"sendMedia\";\n    MessageEventNameEnum[\"QUICK_SEND_MEDIA_FOR_DOWNLOAD\"] = \"quickSendMediaForDownload\";\n    MessageEventNameEnum[\"GET_TAB_INFO\"] = \"getTabInfo\";\n    MessageEventNameEnum[\"THEME_CHANGED\"] = \"themeChanged\";\n})(MessageEventNameEnum || (MessageEventNameEnum = {}));\n","import { findMediaQuickToDownload } from '../downloader/find-media';\nimport { DefaultActionType } from '../storage/storage-def';\nimport { getStorageDefaultActionValue, getStoragePreviousVersionValue } from '../storage/storage-fn';\nimport { MessageEventNameEnum } from '../types/message-event-name.enum';\nimport { contextMenuClicked, createContextMenu, downloadUrl, getTab, getVersion, onActivateTab, onClickExtensionIcon, onCreateTab, onInstalled, onMessage, onReplaceTab, onUpdateTab, openPopup, openSidePanel, sendMessage, setPopupOptions, setSidePanelBehavior, setSidePanelOptions, setStorageValue, } from '../utils/chrome-api';\nimport { downloadImages } from '../utils/download-functions';\nfunction handleUpdate(details) {\n    if (details.reason !== 'update') {\n        return;\n    }\n    const currentVersion = getVersion();\n    getStoragePreviousVersionValue((previousVersion) => {\n        if (previousVersion !== currentVersion) {\n            setStorageValue({ showChangelogLink: true });\n        }\n        setStorageValue({ previousVersion: currentVersion });\n    });\n}\nfunction openDownloader(tab) {\n    getStorageDefaultActionValue((defaultAction) => {\n        switch (defaultAction) {\n            case DefaultActionType.POPUP:\n                openPopup();\n                break;\n            case DefaultActionType.SIDE_PANEL:\n                openSidePanel({ windowId: tab.windowId });\n                break;\n        }\n    });\n}\nfunction updateSidePanelAndPopupBehavior() {\n    const downloaderPath = '/views/downloader.html';\n    getStorageDefaultActionValue((defaultAction) => {\n        const isSidePanel = defaultAction === DefaultActionType.SIDE_PANEL;\n        const isPopup = defaultAction === DefaultActionType.POPUP;\n        const downloaderPathForPopup = isPopup\n            ? downloaderPath\n            : '';\n        const downloaderPathForSidePanel = isSidePanel\n            ? downloaderPath\n            : '';\n        setSidePanelBehavior({ openPanelOnActionClick: isSidePanel });\n        setSidePanelOptions({ path: downloaderPathForSidePanel });\n        setPopupOptions({ popup: downloaderPathForPopup });\n    });\n}\nonUpdateTab((tabId, changeInfo, tab) => {\n    updateSidePanelAndPopupBehavior();\n    sendMessage(MessageEventNameEnum.TAB_UPDATED, { tabId, changeInfo, tab });\n});\nonActivateTab((activeInfo) => {\n    updateSidePanelAndPopupBehavior();\n    sendMessage(MessageEventNameEnum.TAB_ACTIVATED, { tabId: activeInfo.tabId });\n});\nonReplaceTab((addedTabId) => {\n    updateSidePanelAndPopupBehavior();\n    sendMessage(MessageEventNameEnum.TAB_REPLACED, { tabId: addedTabId });\n});\nonCreateTab((tab) => {\n    updateSidePanelAndPopupBehavior();\n    sendMessage(MessageEventNameEnum.TAB_CREATED, { tab });\n});\nonClickExtensionIcon((tab) => {\n    updateSidePanelAndPopupBehavior();\n    openDownloader(tab);\n});\nonInstalled(details => {\n    updateSidePanelAndPopupBehavior();\n    createContextMenu({\n        id: 'downloadAllMedia',\n        title: 'Download all media',\n        contexts: ['page'],\n    });\n    createContextMenu({\n        id: 'quickDownloadImage',\n        title: 'Quick download',\n        contexts: ['image'],\n    });\n    handleUpdate(details);\n});\ncontextMenuClicked((info, tab) => {\n    if (info.menuItemId === 'downloadAllMedia') {\n        findMediaQuickToDownload(tab.id);\n        return;\n    }\n    if (info.menuItemId === 'quickDownloadImage' && info.srcUrl) {\n        downloadUrl(info.srcUrl);\n    }\n});\nonMessage((message, sender, sendResponse) => {\n    var _a;\n    if (!((_a = sender.tab) === null || _a === void 0 ? void 0 : _a.id)) {\n        sendResponse(null);\n        return;\n    }\n    if (message.eventName === MessageEventNameEnum.GET_TAB_INFO) {\n        getTab(sender.tab.id).then(sendResponse);\n        return true;\n    }\n    if (message.eventName === MessageEventNameEnum.QUICK_SEND_MEDIA_FOR_DOWNLOAD) {\n        const media = message.data.media;\n        downloadImages(media);\n        sendResponse(null);\n        return;\n    }\n});\n","import { executeContentScript } from '../utils/chrome-api';\nexport function findMedia(tabId = null) {\n    executeContentScript('/dist/content-script/send_media/send_media.bundle.js', tabId);\n}\nexport function findMediaQuickToDownload(tabId = null) {\n    executeContentScript('/dist/content-script/quick_send_media/quick_send_media.bundle.js', tabId);\n}\n","import { downloadUrl } from './chrome-api';\nexport function downloadSelectedImages(items) {\n    items.filter(item => item.selected)\n        .forEach(item => downloadUrl(item.src));\n}\nexport function downloadImages(items) {\n    items.forEach(item => downloadUrl(item.src));\n}\n"],"names":["DefaultActionType","ThemeType","ItemTypeEnum","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","url","downloadOptions","chrome","downloads","download","obj","callback","storage","sync","get","setStorageValue","set","sendMessage","eventName","data","cb","res","runtime","lastError","response","_a","createContextMenu","properties","contextMenus","create","theme","SYSTEM","defaultAction","POPUP","previousVersion","showChangelogLink","lastOpenSection","IMAGE","filters","filtersOpen","getStorageDefaultActionValue","MessageEventNameEnum","updateSidePanelAndPopupBehavior","downloaderPath","isSidePanel","SIDE_PANEL","downloaderPathForPopup","downloaderPathForSidePanel","options","openPanelOnActionClick","sidePanel","setPanelBehavior","catch","error","console","log","setOptions","setSidePanelOptions","path","action","setPopup","setPopupOptions","popup","Object","keys","tabId","changeInfo","tab","TAB_UPDATED","tabs","onUpdated","addListener","onActivated","activeInfo","TAB_ACTIVATED","onReplaced","addedTabId","TAB_REPLACED","onCreated","TAB_CREATED","onClicked","openPopup","windowId","open","openDownloader","onInstalled","details","id","title","contexts","reason","currentVersion","getManifest","version","handleUpdate","info","menuItemId","srcUrl","scriptUrl_1","this","arguments","scriptUrl","_b","queryOptions","active","lastFocusedWindow","query","startsWith","_c","getCurrentTab","scripting","executeScript","target","allFrames","files","findMediaQuickToDownload","onMessage","message","sender","sendResponse","GET_TAB_INFO","getTab","QUICK_SEND_MEDIA_FOR_DOWNLOAD","media","forEach","item","src"],"sourceRoot":""}