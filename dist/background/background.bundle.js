(()=>{"use strict";var e,n,t,o,a;function c(e,n){chrome.storage.sync.get(e,n)}function i(e,n){try{chrome.runtime.sendMessage({eventName:e,data:n},(e=>{}))}catch(e){}}function d(e){c({defaultAction:n.POPUP},(({defaultAction:t})=>{t||(t=n.POPUP),e(t)}))}function r(e){d((t=>{switch(t){case n.POPUP:chrome.action.openPopup(undefined);break;case n.SIDE_PANEL:!function(e){chrome.sidePanel.open(e)}({windowId:e.windowId})}}))}function s(){const e="/views/downloader.html";d((t=>{const o=t===n.SIDE_PANEL,a=t===n.POPUP?e:"",c=o?e:"";var i;i={openPanelOnActionClick:o},chrome.sidePanel.setPanelBehavior(i).catch((e=>console.log(e))),function(e){chrome.sidePanel.setOptions(e)}({path:c}),function(e){chrome.action.setPopup(e)}({popup:a})}))}(t=e||(e={})).LIGHT="light",t.DARK="dark",t.SYSTEM="system",function(e){e.POPUP="popup",e.SIDE_PANEL="side-panel"}(n||(n={})),e.SYSTEM,n.POPUP,function(e){e.TAB_CREATED="tabCreated",e.TAB_REPLACED="tabReplaced",e.TAB_UPDATED="tabUpdated",e.TAB_ACTIVATED="tabActivated",e.SEND_MEDIA="sendMedia"}(o||(o={})),a=(e,n,t)=>{s(),i(o.TAB_UPDATED,{tabId:e,changeInfo:n,tab:t})},chrome.tabs.onUpdated.addListener(a),chrome.tabs.onActivated.addListener((e=>{s(),i(o.TAB_ACTIVATED,{tabId:e.tabId})})),chrome.tabs.onReplaced.addListener((e=>{s(),i(o.TAB_REPLACED,{tabId:e})})),chrome.tabs.onCreated.addListener((e=>{s(),i(o.TAB_CREATED,{tab:e})})),chrome.action.onClicked.addListener((e=>{s(),r(e)})),chrome.runtime.onInstalled.addListener((e=>{var n;s(),n={id:"openMediaDownloader",title:"Media Downloader",contexts:["all"]},chrome.contextMenus.create(n),function(e){if("update"!==e.reason)return;const n=chrome.runtime.getManifest().version;var t;t=e=>{var t;e!==n&&chrome.tabs.create({url:"views/changelog.html"}),t={previousVersion:n},chrome.storage.sync.set(t)},c({previousVersion:null},(({previousVersion:e})=>{e||(e=null),t(e)}))}(e)})),chrome.contextMenus.onClicked.addListener(((e,n)=>{n&&((e,n)=>{"openMediaDownloader"===e.menuItemId&&r(n)})(e,n)}))})();