(()=>{"use strict";var e,t,n,o,a;function c(e,t){chrome.storage.sync.get(e,t)}function i(e,t){try{chrome.runtime.sendMessage({eventName:e,data:t},(e=>{}))}catch(e){}}function d(e){c({defaultAction:t.POPUP},(({defaultAction:n})=>{n||(n=t.POPUP),e(n)}))}function r(e){d((n=>{switch(n){case t.POPUP:chrome.action.openPopup();break;case t.SIDE_PANEL:chrome.sidePanel.open({windowId:e.windowId})}}))}function s(){const e="/views/downloader.html";d((n=>{const o=n===t.SIDE_PANEL,a=n===t.POPUP?e:"",c=o?e:"";var i;i={openPanelOnActionClick:o},chrome.sidePanel.setPanelBehavior(i).catch((e=>console.log(e))),function(e){chrome.sidePanel.setOptions(e)}({path:c}),function(e){chrome.action.setPopup(e)}({popup:a})}))}(n=e||(e={})).LIGHT="light",n.DARK="dark",n.SYSTEM="system",function(e){e.POPUP="popup",e.SIDE_PANEL="side-panel"}(t||(t={})),e.SYSTEM,t.POPUP,function(e){e.TAB_CREATED="tabCreated",e.TAB_REPLACED="tabReplaced",e.TAB_UPDATED="tabUpdated",e.TAB_ACTIVATED="tabActivated",e.SEND_MEDIA="sendMedia"}(o||(o={})),chrome.tabs.onUpdated.addListener(((e,t,n)=>{s(),i(o.TAB_UPDATED,{tabId:e,changeInfo:t,tab:n})})),chrome.tabs.onActivated.addListener((e=>{s(),i(o.TAB_ACTIVATED,{tabId:e.tabId})})),chrome.tabs.onReplaced.addListener((e=>{s(),i(o.TAB_REPLACED,{tabId:e})})),chrome.tabs.onCreated.addListener((e=>{s(),i(o.TAB_CREATED,{tabId:e})})),chrome.action.onClicked.addListener((e=>{s(),r(e)})),chrome.runtime.onInstalled.addListener((e=>{s(),chrome.contextMenus.create({id:"openMediaDownloader",title:"Media Downloader",contexts:["all"]}),function(e){if("update"===e.reason){const e=chrome.runtime.getManifest().version;t=t=>{t!==e&&chrome.tabs.create({url:"views/changelog.html"}),chrome.storage.sync.set({previousVersion:e})},c({previousVersion:null},(({previousVersion:e})=>{e||(e=null),t(e)}))}var t}(e)})),a=(e,t)=>{"openMediaDownloader"===e.menuItemId&&r(t)},chrome.contextMenus.onClicked.addListener(((e,t)=>{t&&a(e,t)}))})();